server {
    server_name *.zdoo.com;
    listen 80;

    root /app/zdoo/ranzhi/www;
    index index.php;

    location ^~ /pm
    {
        root /app/zdoo/zentao/www/;
        index index.php;

        try_files $uri $uri/ /pm/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/pm(/.*)$")
            {
              set $path_info $1;
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /portal
    {
        root /app/zdoo/chanzhi/www;
        index index.php;
        try_files $uri $uri/ /portal/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/portal(/.*)$")
            {
              set $path_info $1;
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /sys
    {
        try_files $uri $uri/ /sys/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/sys(/.*)$")
            {
              set $path_info $1;
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /crm
    {
        try_files $uri $uri/ /crm/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/crm(/.*)$")
            {
              set $path_info $1;
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /oa
    {
        try_files $uri $uri/ /oa/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/oa(/.*)$")
            {
              set $path_info $1;
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /cash
    {
        try_files $uri $uri/ /cash/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/cash(/.*)$")
            {   
              set $path_info $1; 
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /hr
    {
        try_files $uri $uri/ /hr/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/hr(/.*)$")
            {
              set $path_info $1; 
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /flow
    {
        try_files $uri $uri/ /flow/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/flow(/.*)$")
            {
              set $path_info $1; 
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /editor
    {
        try_files $uri $uri/ /editor/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/editor(/.*)$")
            {
              set $path_info $1; 
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ^~ /team
    {
        try_files $uri $uri/ /team/index.php?$args;

        location ~ \.php
        {
            set $path_info $request_uri;
            if ($request_uri ~ "^/team(/.*)$")
            {
              set $path_info $1; 
            }
            fastcgi_index index.php;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
            include      fastcgi_params;
            fastcgi_param PATH_INFO $path_info;
        }
    }

    location ~ \.php
    {
        fastcgi_index index.php;
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        include      fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
	    fastcgi_param PATH_INFO $request_uri;
    }
}
